// AOS.init();
document.addEventListener('DOMContentLoaded', function (e) {

  // 1. Load the sidebar
  fetch('sidebar.html')
    .then(response => {
      if (!response.ok) throw new Error('Sidebar not found');
      return response.text();
    })
    .then(html => {
      document.getElementById('sidebar-container').innerHTML = html;

      // Scroll-based highlighting only on index.html
      if (document.body.dataset.page === 'index') {
        const navLinks = document.querySelectorAll('.sidebar-link');
        const sections = Array.from(document.querySelectorAll('section[id]'));

        function highlightOnScroll() {
          const scrollY = window.scrollY;

          sections.forEach(section => {
            const offsetTop = section.offsetTop - 100;
            const offsetBottom = offsetTop + section.offsetHeight;
            const id = section.getAttribute('id');

            if (scrollY >= offsetTop && scrollY < offsetBottom) {
              navLinks.forEach(link => {
                link.classList.toggle('active', link.getAttribute('href') === `#${id}`);
              });
            }
          });
        }

        highlightOnScroll();
        window.addEventListener('scroll', highlightOnScroll);
      }
    })
    .catch(err => console.error('Sidebar load error:', err));

  // 2. Initialize AOS (Animate On Scroll)
  if (typeof AOS !== 'undefined') {
    AOS.init({
      once: true,
      duration: 800,
      easing: 'ease-in-out',
    });
  } else {
    console.warn('AOS not loaded');
  }

  // 3. Scroll Progress Bar
  const progressBar = document.getElementById('scrollBar');
  window.addEventListener('scroll', () => {
    const scrollTop = window.scrollY;
    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
    const scrollPercent = (scrollTop / docHeight) * 100;
    if (progressBar) {
      progressBar.style.width = scrollPercent + '%';
    }
  });

});

